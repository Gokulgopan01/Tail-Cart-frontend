<div class="profile-page">
  <!-- Header with tabs -->
  <div class="profile-header">
    <div class="container">
      <div class="header-content">
        <h1 class="page-title">Owner Profile</h1>
        <div class="tab-navigation">
          <button class="tab-btn active" (click)="switchTab('owner')">
            Owner Profile
          </button>
          <button class="tab-btn" (click)="switchTab('pets')">
            My Pets
          </button>
        </div>
      </div>
    </div>
  </div>

  <div class="container">
    <!-- Owner Profile Tab -->
    <div class="tab-content" [class.active]="activeTab === 'owner'">
      <div class="profile-card">
        <div class="profile-card-header">
          <div class="header-title">
            <h2>Owner Profile</h2>
            <button *ngIf="hasProfile && !isEditMode" class="edit-btn" (click)="toggleEditMode()">
              Edit
            </button>
          </div>
        </div>

        <div class="profile-card-body">
          <!-- View Mode -->
          <div *ngIf="hasProfile && !isEditMode" class="profile-view">
            <div class="profile-field">
              <label>Full Name</label>
              <p class="field-value">{{ profile.owner_name || 'Not provided' }}</p>
            </div>
            
            <div class="profile-field">
              <label>Address</label>
              <p class="field-value">{{ profile.owner_address || 'Not provided' }}</p>
            </div>
            
            <div class="profile-field">
              <label>Phone Number</label>
              <p class="field-value">{{ profile.owner_phone || 'Not provided' }}</p>
            </div>
            
            <div class="row-fields">
              <div class="profile-field half">
                <label>City</label>
                <p class="field-value">{{ profile.owner_city || 'Not provided' }}</p>
              </div>
              <div class="profile-field half">
                <label>State</label>
                <p class="field-value">{{ profile.owner_state || 'Not provided' }}</p>
              </div>
            </div>
          </div>

          <!-- Edit Mode -->
          <div *ngIf="isEditMode" class="profile-edit">
            <form (ngSubmit)="onSubmit()" #profileForm="ngForm">
              <div class="form-field">
                <label for="owner_name">Full Name</label>
                <input type="text" id="owner_name" name="owner_name" 
                       [(ngModel)]="profile.owner_name" required
                       placeholder="Enter your full name"
                       class="form-input">
              </div>
              
              <div class="form-field">
                <label for="owner_address">Address</label>
                <input type="text" id="owner_address" name="owner_address" 
                       [(ngModel)]="profile.owner_address" required
                       placeholder="Enter your address"
                       class="form-input">
              </div>
              
              <div class="form-field">
                <label for="owner_phone">Phone Number</label>
                <input type="tel" id="owner_phone" name="owner_phone" 
                       [(ngModel)]="profile.owner_phone" required
                       placeholder="Enter your phone number"
                       class="form-input">
              </div>
              
              <div class="row-fields">
                <div class="form-field half">
                  <label for="owner_city">City</label>
                  <input type="text" id="owner_city" name="owner_city" 
                         [(ngModel)]="profile.owner_city" required
                         placeholder="Enter your city"
                         class="form-input">
                </div>
                <div class="form-field half">
                  <label for="owner_state">State</label>
                  <input type="text" id="owner_state" name="owner_state" 
                         [(ngModel)]="profile.owner_state" required
                         placeholder="Enter your state"
                         class="form-input">
                </div>
              </div>
              
              <div class="form-actions">
                <button type="submit" class="save-btn" [disabled]="profileForm.invalid || isLoading">
                  {{ isLoading ? 'Saving...' : 'Save Profile' }}
                </button>
                <button type="button" class="cancel-btn" (click)="cancelEdit()">
                  Cancel
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

    <!-- Pets Tab -->
    <div class="tab-content" [class.active]="activeTab === 'pets'">
      <div class="pets-section">
        <div class="pets-header">
          <h2>My Pets</h2>
          <button class="add-pet-btn" (click)="startAddPet()">
            Add Pet
          </button>
        </div>

        <!-- Loading -->
        <div *ngIf="loadingPets" class="loading-state">
          <p>Loading pets...</p>
        </div>

        <!-- No Pets -->
        <div *ngIf="!loadingPets && pets.length === 0" class="no-pets">
          <div class="no-pets-content">
            <p>No pets added yet. Add your first pet!</p>
            <button class="add-pet-btn" (click)="startAddPet()">
              Add Pet
            </button>
          </div>
        </div>

        <!-- Pets Grid -->
        <div *ngIf="!loadingPets && pets.length > 0" class="pets-grid">
          <div class="pet-card" *ngFor="let pet of pets">
            <div class="pet-card-header">
              <h3>{{ pet.pet_name }}</h3>
              <div class="pet-species">{{ pet.species }}</div>
            </div>
            
            <div class="pet-details">
              <div class="pet-breed">
                {{ pet.breed || 'Breed not specified' }}
              </div>
              
              <!-- Pet ID Highlight (Crucial Section) -->
              <div class="pet-id-section">
                <div class="pet-id-label">PFI ID</div>
                <div class="pet-id-value">{{ pet.pet_id || 'Generating...' }}</div>
                <div class="pet-id-note">Required for purchases & document uploads</div>
              </div>
              
              <div class="pet-actions">
                <button class="edit-pet-btn" (click)="editPet(pet)">
                  Edit
                </button>
                <button class="delete-pet-btn" (click)="deletePet(pet)">
                  Delete
                </button>
              </div>
            </div>
          </div>
          
          <!-- Add Pet Card -->
          <div class="pet-card add-pet-card" (click)="startAddPet()">
            <div class="add-pet-content">
              <div class="add-icon">+</div>
              <h3>Add New Pet</h3>
              <p>Add another furry friend</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Add/Edit Pet Modal -->
  <div *ngIf="isPetFormVisible" class="modal-overlay" (click)="cancelPetForm()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h3>{{ editingPet ? 'Edit Pet' : 'Add New Pet' }}</h3>
        <button class="close-btn" (click)="cancelPetForm()">Ã—</button>
      </div>
      
      <form (ngSubmit)="savePet()" #petForm="ngForm" class="modal-form">
        <div class="form-field">
          <label for="pet_name">Pet Name</label>
          <input type="text" id="pet_name" name="pet_name" 
                 [(ngModel)]="currentPet.pet_name" required
                 placeholder="What's your pet's name?"
                 class="form-input">
        </div>
        
        <div class="form-field">
          <label for="species">Species</label>
          <select id="species" name="species" 
                  [(ngModel)]="currentPet.species" required
                  class="form-select">
            <option value="">Select species</option>
            <option value="Dog">Dog</option>
            <option value="Cat">Cat</option>
            <option value="Fish">Fish</option>
            <option value="Bird">Bird</option>
            <option value="Rabbit">Rabbit</option>
            <option value="Other">Other</option>
          </select>
        </div>
        
        <div class="form-field">
          <label for="breed">Breed (optional)</label>
          <input type="text" id="breed" name="breed" 
                 [(ngModel)]="currentPet.breed"
                 placeholder="e.g., Golden Retriever, Persian"
                 class="form-input">
        </div>
        
        <div class="form-actions">
          <button type="submit" class="save-btn" [disabled]="petForm.invalid || loadingPets">
            {{ loadingPets ? 'Saving...' : (editingPet ? 'Update Pet' : 'Add Pet') }}
          </button>
          <button type="button" class="cancel-btn" (click)="cancelPetForm()">
            Cancel
          </button>
        </div>
      </form>
    </div>
  </div>
</div>